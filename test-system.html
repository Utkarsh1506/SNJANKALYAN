<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test ID Card System - Demo</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 30px;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .test-header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        .test-header h1 {
            color: #2C3E50;
            margin-bottom: 10px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #F8F9FA;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }
        .test-section h3 {
            color: #2C3E50;
            margin-bottom: 15px;
        }
        .btn-test {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s;
        }
        .btn-test:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        .result-box {
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 5px;
            border: 2px solid #ECF0F1;
            font-family: monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
        }
        .success {
            color: #27AE60;
            font-weight: bold;
        }
        .error {
            color: #E74C3C;
            font-weight: bold;
        }
        .info {
            color: #3498DB;
            font-weight: bold;
        }
        .quick-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .quick-link-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            text-decoration: none;
            transition: all 0.3s;
        }
        .quick-link-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
            text-decoration: none;
            color: white;
        }
        .quick-link-card h4 {
            margin-bottom: 10px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .stat-item {
            padding: 15px;
            background: white;
            border-radius: 5px;
            border-left: 4px solid #667eea;
        }
        .stat-label {
            font-size: 12px;
            color: #7F8C8D;
            margin-bottom: 5px;
        }
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #2C3E50;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>üß™ ID Card System - Testing & Demo</h1>
            <p class="text-muted">Test all features and generate sample data</p>
        </div>

        <!-- System Status -->
        <div class="test-section">
            <h3>üìä System Status</h3>
            <div class="stats-grid" id="statsGrid">
                <div class="stat-item">
                    <div class="stat-label">Pending Applications</div>
                    <div class="stat-value" id="statPending">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Approved Members</div>
                    <div class="stat-value" id="statApproved">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Total Members</div>
                    <div class="stat-value" id="statTotal">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">System Status</div>
                    <div class="stat-value" style="font-size: 16px; color: #27AE60;">‚úÖ Ready</div>
                </div>
            </div>
            <button class="btn-test" onclick="refreshStats()">üîÑ Refresh Stats</button>
        </div>

        <!-- Quick Actions -->
        <div class="test-section">
            <h3>‚ö° Quick Actions</h3>
            <button class="btn-test" onclick="generateSampleData()">
                üé≤ Generate Sample Members
            </button>
            <button class="btn-test" onclick="approveAllPending()">
                ‚úÖ Approve All Pending
            </button>
            <button class="btn-test" onclick="testIDCardGeneration()">
                üé® Test ID Card Generation
            </button>
            <button class="btn-test" onclick="exportAllData()">
                üíæ Export All Data
            </button>
            <button class="btn-test" onclick="clearAllData()" style="background: linear-gradient(135deg, #E74C3C, #C0392B);">
                üóëÔ∏è Clear All Data
            </button>
            <div class="result-box" id="quickActionsResult"></div>
        </div>

        <!-- Test Registration -->
        <div class="test-section">
            <h3>üìù Test Registration</h3>
            <button class="btn-test" onclick="testRegistration()">
                Test Single Registration
            </button>
            <button class="btn-test" onclick="testBulkRegistration()">
                Test Bulk Registration (10 members)
            </button>
            <div class="result-box" id="registrationResult"></div>
        </div>

        <!-- Test Verification -->
        <div class="test-section">
            <h3>üîê Test Verification</h3>
            <div style="margin-bottom: 15px;">
                <input type="text" id="testUserId" placeholder="User ID (e.g., SNJ1001)" 
                       style="padding: 10px; width: 200px; border: 2px solid #ECF0F1; border-radius: 5px;">
                <input type="date" id="testDob" 
                       style="padding: 10px; width: 200px; border: 2px solid #ECF0F1; border-radius: 5px;">
                <button class="btn-test" onclick="testVerification()">
                    Test Verification
                </button>
            </div>
            <div class="result-box" id="verificationResult"></div>
        </div>

        <!-- Quick Navigation -->
        <div class="test-section">
            <h3>üîó Quick Navigation</h3>
            <div class="quick-links">
                <a href="member-register.html" class="quick-link-card">
                    <h4>üìù Registration</h4>
                    <p>Register New Member</p>
                </a>
                <a href="idcard-download.html" class="quick-link-card">
                    <h4>üí≥ Download ID</h4>
                    <p>Download ID Card</p>
                </a>
                <a href="admin-panel.html" class="quick-link-card">
                    <h4>üõ°Ô∏è Admin Panel</h4>
                    <p>Manage Members</p>
                </a>
                <a href="JAVASCRIPT_ID_CARD_SYSTEM.md" class="quick-link-card" target="_blank">
                    <h4>üìö Documentation</h4>
                    <p>Read Full Docs</p>
                </a>
            </div>
        </div>

        <!-- System Info -->
        <div class="test-section">
            <h3>‚ÑπÔ∏è System Information</h3>
            <div class="result-box" id="systemInfo"></div>
            <button class="btn-test" onclick="showSystemInfo()">
                Show System Info
            </button>
        </div>
    </div>

    <script src="js/member-system.js"></script>
    <script src="js/idcard-generator.js"></script>
    <script>
        // Sample data for testing
        const sampleMembers = [
            { name: "Rajesh Kumar", sonof: "Mohan Kumar", dob: "1990-05-15", gender: "Male", bloodGroup: "O+", mobile: "9876543210", email: "rajesh@example.com", address: "123 MG Road, Bangalore, Karnataka - 560001" },
            { name: "Priya Sharma", sonof: "Anil Sharma", dob: "1992-08-20", gender: "Female", bloodGroup: "A+", mobile: "9876543211", email: "priya@example.com", address: "456 Park Street, Mumbai, Maharashtra - 400001" },
            { name: "Amit Patel", sonof: "Ramesh Patel", dob: "1988-03-10", gender: "Male", bloodGroup: "B+", mobile: "9876543212", email: "amit@example.com", address: "789 Gandhi Nagar, Ahmedabad, Gujarat - 380001" },
            { name: "Sneha Reddy", sonof: "Krishna Reddy", dob: "1995-11-25", gender: "Female", bloodGroup: "AB+", mobile: "9876543213", email: "sneha@example.com", address: "321 Jubilee Hills, Hyderabad, Telangana - 500033" },
            { name: "Vikram Singh", sonof: "Balwant Singh", dob: "1987-07-18", gender: "Male", bloodGroup: "O-", mobile: "9876543214", email: "vikram@example.com", address: "654 Civil Lines, Delhi - 110054" },
        ];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            refreshStats();
            showSystemInfo();
        });

        // Refresh statistics
        function refreshStats() {
            const pending = memberSystem.getPendingMembers();
            const approved = memberSystem.getApprovedMembers();
            
            document.getElementById('statPending').textContent = pending.length;
            document.getElementById('statApproved').textContent = approved.length;
            document.getElementById('statTotal').textContent = pending.length + approved.length;
        }

        // Generate sample data
        function generateSampleData() {
            const result = document.getElementById('quickActionsResult');
            result.innerHTML = '<div class="info">Generating sample members...</div>';
            
            let generated = 0;
            sampleMembers.forEach(member => {
                const res = memberSystem.registerMember(member);
                if (res.success) {
                    generated++;
                    result.innerHTML += `<div class="success">‚úÖ Generated: ${res.userId} - ${member.name}</div>`;
                }
            });
            
            result.innerHTML += `<div class="info">Total generated: ${generated} members</div>`;
            refreshStats();
        }

        // Approve all pending
        function approveAllPending() {
            const result = document.getElementById('quickActionsResult');
            const pending = memberSystem.getPendingMembers();
            
            if (pending.length === 0) {
                result.innerHTML = '<div class="error">No pending members to approve</div>';
                return;
            }
            
            result.innerHTML = '<div class="info">Approving all pending members...</div>';
            
            let approved = 0;
            pending.forEach(member => {
                const res = memberSystem.approveMember(member.userId);
                if (res.success) {
                    approved++;
                    result.innerHTML += `<div class="success">‚úÖ Approved: ${member.userId} - ${member.name}</div>`;
                }
            });
            
            result.innerHTML += `<div class="info">Total approved: ${approved} members</div>`;
            refreshStats();
        }

        // Test ID card generation
        async function testIDCardGeneration() {
            const result = document.getElementById('quickActionsResult');
            const approved = memberSystem.getApprovedMembers();
            
            if (approved.length === 0) {
                result.innerHTML = '<div class="error">No approved members found. Generate and approve some members first.</div>';
                return;
            }
            
            const member = approved[0];
            result.innerHTML = `<div class="info">Generating ID card for: ${member.name} (${member.userId})...</div>`;
            
            try {
                // Create a temporary canvas
                const canvas = document.createElement('canvas');
                canvas.id = 'tempCanvas';
                canvas.style.display = 'none';
                document.body.appendChild(canvas);
                
                const gen = new IDCardGenerator('tempCanvas');
                await gen.generateIDCard(member);
                
                result.innerHTML = `<div class="success">‚úÖ ID card generated successfully!</div>`;
                result.innerHTML += `<img src="${canvas.toDataURL()}" style="max-width: 100%; border-radius: 10px; margin-top: 10px;">`;
                
                // Clean up
                setTimeout(() => {
                    document.body.removeChild(canvas);
                }, 100);
            } catch (error) {
                result.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
            }
        }

        // Export all data
        function exportAllData() {
            const result = document.getElementById('quickActionsResult');
            const data = memberSystem.exportData();
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `test-export-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            result.innerHTML = `
                <div class="success">‚úÖ Data exported successfully!</div>
                <div class="info">
                    Approved: ${data.approved.length}<br>
                    Pending: ${data.pending.length}<br>
                    Counter: ${data.counter}
                </div>
            `;
        }

        // Clear all data
        function clearAllData() {
            if (confirm('‚ö†Ô∏è This will delete ALL test data. Continue?')) {
                memberSystem.clearAllData();
                document.getElementById('quickActionsResult').innerHTML = 
                    '<div class="success">‚úÖ All data cleared successfully!</div>';
                refreshStats();
            }
        }

        // Test single registration
        function testRegistration() {
            const member = {
                name: "Test User " + Date.now(),
                sonof: "Test Parent",
                dob: "1990-01-01",
                gender: "Male",
                bloodGroup: "O+",
                mobile: "9999999999",
                email: "test@example.com",
                address: "Test Address, Test City"
            };
            
            const result = memberSystem.registerMember(member);
            const output = document.getElementById('registrationResult');
            
            if (result.success) {
                output.innerHTML = `
                    <div class="success">‚úÖ Registration Successful!</div>
                    <div class="info">
                        User ID: ${result.userId}<br>
                        Name: ${result.member.name}<br>
                        Status: ${result.member.status}<br>
                        Registration Date: ${new Date(result.member.registrationDate).toLocaleString()}
                    </div>
                `;
            } else {
                output.innerHTML = `<div class="error">‚ùå Error: ${result.error}</div>`;
            }
            
            refreshStats();
        }

        // Test bulk registration
        function testBulkRegistration() {
            const output = document.getElementById('registrationResult');
            output.innerHTML = '<div class="info">Registering 10 test members...</div>';
            
            let success = 0;
            for (let i = 0; i < 10; i++) {
                const member = {
                    name: `Test Member ${i + 1}`,
                    sonof: `Test Parent ${i + 1}`,
                    dob: "1990-01-01",
                    gender: i % 2 === 0 ? "Male" : "Female",
                    bloodGroup: ["A+", "A-", "B+", "B-", "O+", "O-", "AB+", "AB-"][i % 8],
                    mobile: `98765432${i.toString().padStart(2, '0')}`,
                    email: `test${i + 1}@example.com`,
                    address: `Test Address ${i + 1}, Test City`
                };
                
                const result = memberSystem.registerMember(member);
                if (result.success) {
                    success++;
                    output.innerHTML += `<div class="success">‚úÖ ${result.userId} - ${member.name}</div>`;
                }
            }
            
            output.innerHTML += `<div class="info">Successfully registered: ${success}/10 members</div>`;
            refreshStats();
        }

        // Test verification
        function testVerification() {
            const userId = document.getElementById('testUserId').value;
            const dob = document.getElementById('testDob').value;
            const output = document.getElementById('verificationResult');
            
            if (!userId || !dob) {
                output.innerHTML = '<div class="error">Please enter both User ID and Date of Birth</div>';
                return;
            }
            
            const result = memberSystem.verifyMember(userId, dob);
            
            if (result.success) {
                output.innerHTML = `
                    <div class="success">‚úÖ Verification Successful!</div>
                    <div class="info">
                        Name: ${result.member.name}<br>
                        User ID: ${result.member.userId}<br>
                        Status: ${result.member.status}<br>
                        Blood Group: ${result.member.bloodGroup}<br>
                        Mobile: ${result.member.mobile}
                    </div>
                `;
            } else {
                output.innerHTML = `<div class="error">‚ùå ${result.error}</div>`;
            }
        }

        // Show system info
        function showSystemInfo() {
            const output = document.getElementById('systemInfo');
            const info = {
                'Browser': navigator.userAgent.split(' ').pop(),
                'localStorage Available': typeof(Storage) !== "undefined" ? "Yes" : "No",
                'Canvas Support': document.createElement('canvas').getContext ? "Yes" : "No",
                'Current Date': new Date().toLocaleString(),
                'System Version': '1.0',
                'Technology': 'Pure JavaScript (No PHP)'
            };
            
            let html = '';
            for (const [key, value] of Object.entries(info)) {
                html += `<strong>${key}:</strong> ${value}<br>`;
            }
            
            output.innerHTML = html;
        }
    </script>
</body>
</html>
